{% extends "cosinnus/base.html" %}
{% load i18n thumbnail cosinnus_tags %}

{% block page_title %}
  {% blocktrans %}Community-Tours Blog{% endblocktrans %}
{% endblock %}

{% block body %}Blog{% endblock body %}

{% block content %}
<div class="row">
  <div class="col-xs-12">
    {% for post in object_list %}
      {% if post.tags %}
      {% for tag in tags %}
        <a href="{% url 'cosinnus:note:list-filtered' group=group.slug tag=tag.slug %}"><span class="label">{{ tag.name }}</span></a>
      {% endfor %}
      {% else %}
        {% trans "No tags available." %}
      {% endif %}
    {% endfor %}
  </div>  
</div>
<div class="row">
  <div class="posts col-xs-12">
  <h2>{% trans "Blog Posts" %}</h2>
  {% for post in object_list %}
  <div class="post row">
    {% if post.image %}
        <div class="col-xs-12 col-sm-4">
          <a href="{% url 'cosinnus:note:note' group=post.group.slug slug=post.slug %}">
            <img src="{{ post.image|thumbnail_url:"note_medium" }}" alt="{{ post.title }}" width="100%"/>
          </a>
        </div>
        <div class="col-xs-12 col-sm-8">
          <a href="{% url 'cosinnus:note:note' group=post.group.slug slug=post.slug %}">
            <h3>{{ post.title }}</h3>
          </a>
          <span class="details">
            written by <a href="{% url 'pioneer-detail' username=post.creator.get_username %}">{{ post.creator.get_full_name|default:post.creator.username }}</a> on {{ post.created }} in <a href="{% url 'caravan-detail' group=post.group.slug %}">{{ post.group.slug }}</a>
          </span>
          {{ post.text|urlize|linebreaksbr|safe|truncatewords:80 }}</br>
          <a class="more" href="{% url 'cosinnus:note:note' group=post.group.slug slug=post.slug %}">read more</a>
        </div>
      </a>
    {% else %}
        <div class="col-xs-12">
          <a href="{% url 'cosinnus:note:note' group=post.group.slug slug=post.slug %}">
            <h3>{{ post.title }}</h3>
          </a>
          <span class="details">
            written by <a href="{% url 'pioneer-detail' username=post.creator.get_username %}">{{ post.creator.get_full_name|default:post.creator.username }}</a> on {{ post.created }} in <a href="{% url 'caravan-detail' group=post.group.slug %}">{{ post.group.slug }}</a>
          </span>
          {{ post.text|urlize|linebreaksbr|safe|truncatewords:80 }}</br>
          <a class="more" href="{% url 'cosinnus:note:note' group=post.group.slug slug=post.slug %}">read more</a>
        </div>
    </a>
    {% endif %}
  </div>
  {% endfor %}
  </div>
</div>

{% endblock %}